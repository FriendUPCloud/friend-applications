
    <h2>
        Welcome {fullname}
    </h2>
    
    <div id="dashActiveClassesHead" class="ContentHeader">
        <h2>
            Active classrooms:
        </h2>
    </div>
    <div id="dashActiveClasses" class="ContentBlock">
        <!-- sharts go here -->        
    </div>
    
    <!--
    <div class="BoxContainer">
        ..
    </div>
    
    <hr/>
    
-->
    <div id="dashStatusHead" class="ContentHeader">
        <h2>
            Status
        </h2>
    </div>
    <div id="dashStatus" class="ContentBlock">
        
    </div>
    
    <p>
        <strong>Activity log:</strong>
    </p>
    <div class="BoxContainer">
        ...
    </div>
    
    <script>
Application.submodules.dashboard = {
    init()
    {
        const self = this;
        self.classCharts = ge( 'dashActiveClasses' );
        self.status = ge( 'dashStatus' );
        const m = new Module( 'system' );
        m.onExecuted = ( s, d ) =>
        {
            if ( 'ok' == s )
            {
                const res = JSON.parse( d );
                console.log( 'dashboard init activeclasses', res );
                let l = res.activeclasses.length;
                const cIds = [];
                for( ;l; )
                {
                    l--;
                    cIds[l] = parseInt( res.activeclasses[l].ID, 10 );
                }
                
                console.log( 'cIds', cIds );
                let cl = new Module( 'system' );
                cl.onExecuted = function( s, d )
                {
                    console.log( 'classroom completedness', [ s, d ] );
                    if ( 'fail' == s || !d )
                    {
                        let l = res.activeclasses.length;
                        for( ;l; )
                        {
                            l--;
                            res.activeclasses[l].Progress = null;
                            self.addClassStatus( res.activeclasses[ l ]);
                        }
                    }
                    else
                    {
                        const pres = JSON.parse( d );
                        console.log( 'pres', pres );
                        let pl = pres.length;
                        for( ;pl; )
                        {
                            pl--;
                            const p = pres[ pl ];
                            console.log( 'p', p );
                            let cl = res.activeclasses.length;
                            for( ;cl; )
                            {
                                cl--;
                                const c = res.activeclasses[ cl ];
                                console.log( 'compare', [ p, c ]);
                                
                            }
                        }
                    }
                    // returns returnData upon OK returnCode:
                    // {"6":0,"13":0,"41":50} where key is CourseID
                    
                }
                cl.execute( 'appmodule', {
                    appName: 'Courses',
                    command: 'getclassroomprogress',
                    classrooms: cIds // Classroom IDs array
                } );
                
            }
            else
            {
                console.log( 'dashboard activeclasses fail', [ s, d ]);
                console.log( JSON.parse( d ));
            }
        }
        m.execute( 'appmodule', {
            appName : 'CourseCreator',
            command : 'submodule',
            vars    : {
                method    : 'activeclasses',
                submodule : 'dashboard'
            }
        } );
        const s = new Module( 'system' );
        s.onExecuted = ( s, d ) => {
            if ( 'ok' == s )
            {
                console.log( 'dashboard status back', [ s, d ]);
                const res = JSON.parse( d );
                console.log( 'status res', res );
                const studs = res.students || {
                    mainNum : 12,
                    mainIcon : 'fa-users',
                    mainText : 'Students',
                    subStat  : 5,
                    subText  : 'currently online',
                };
                const sesss = res.sessions || {
                    mainNum : 4,
                    mainIcon : 'fa-clock-o',
                    mainText : 'Active sessions today',
                    subStat  : undefined,
                    subText  : undefined,
                };
                const courses = res.courses || {
                    mainNum : 45,
                    mainIcon : 'fa-book',
                    mainText : 'Completed courses',
                };
                self.addStatusBox( studs, '#27bcaf' );
                self.addStatusBox( sesss, '#ff7364' );
                self.addStatusBox( courses, '#9b59b6' );
            }
            else
            {
                console.log( 'dashboard status fail', [ s, d ]);
            }
        }
        s.execute( 'appmodule', {
            appName : 'CourseCreator',
            command : 'submodule',
            vars    : {
                submodule : 'dashboard',
                method    : 'status',
            }
        } );
    },
    
    addClassStatus( klass )
    {
        console.log( 'addClassStatus', klass );
        const self = this;
        const cEl = document.createElement( 'div' );
        self.classCharts.appendChild( cEl );
        const cOpts = {
            containerElement : cEl,
            //chart            : conf,
        };
        const c = new ccChart( cOpts );
        console.log( 'dashboard.addClassStatus', c );
        const cs = new Module( 'system' );
        cs.onExecuted = ( s, d ) =>
        {
            console.log( 'addClassStatus', [ s, d ] );
            const res = JSON.parse( d );
            console.log( 'stats', res );
            if ( null == klass.Progress )
                klass.Progress = Math.floor( Math.random() * 100 );
            if( null == klass.Users )
                klass.Users = Math.floor( Math.random() * 30 );
            
            console.log( 'prog', klass.Progress );
            let pColor = '#25bbaf';
            if ( null != klass.Progress )
            {
                if ( klass.Progress > 35 )
                    pColor = '#27bcaf';
                if ( klass.Progress > 75 )
                    pColor = '#ff7363';
                if ( klass.Progress > 91 )
                    pColor = '#d85c4f'
            }
            
            const data = {
                labels : [
                    'complete',
                    '',
                ],
                datasets : [{
                    label : 'test chart label',
                    data  : [ 
                        klass.Progress, 
                        ( 100 - klass.Progress ),
                    ],
                    backgroundColor : [
                        pColor,
                        'rgb(230, 230, 230 )',
                    ],
                }],
            };
            
            const conf = {
                type    : 'doughnut',
                data    : data,
                options : {
                    plugins : {
                        legend : {
                            display : false,
                        },
                    },
                    cutout : '80%',
                },
            };
            console.log( 'C', c );
            c.setData( conf, {
                label1: klass.Name || 'Classname',
                label2: ( klass.Users ? klass.Users + ' Users' : 'no u' ),
                progress : klass.Progress + '%',
            } );
            
        }
        cs.execute( 'appmodule', {
            appName : 'CourseCreator',
            command : 'submodule',
            vars    : {
                method    : 'classtats',
                submodule : 'dashboard',
                classId   : klass.ID,
            }
        } );
    },
    
    addStatusBox( data, bgColor )
    {
        const self = this;
        console.log( 'addStatusBox', data );
        const sEl = document.createElement( 'div' );
        self.status.appendChild( sEl );
        const sOpts = {
            containerElement : sEl,
            bgColor          : bgColor,
        };
        const s = new ccStatBox( sOpts );
        s.setData( data );
    },
    
}

Application.submodules.dashboard.init();
    </script>
    <style>
        #dashStatus,
        #dashActiveClasses {
            display         : flex;
            flex-wrap       : wrap;
            justify-content : center;
        }
        
        .klasStatsBox
        {
            position: relative;
            width : 150px;
            height: 200px;
            /*background-color: lightgrey;*/
            margin-right : 1em;
            text-align: center;
        }
        
        .klasStatsBox > div:nth-child(3)
        {
            font-weight: bold;
        }
        
        .klasStatsBox > div:nth-child(4)
        {
            position: absolute;
            top : 50px;
            width: 100%;
            font-size: 2.5em;
            font-weight: bold;
        }
        
        #dashStatus
        {
            
        }
        
        #dashStatus .ccStatBox
        {
            padding      : 0.5em;
            margin-right : 1em;
            color        : white;
            height       : 7em;
        }
        
        .ccStatBox
        {
            
        }
        
        .statboxMain
        {
            display         : flex;
            font-size       : 3em;
            justify-content : center;
        }
        
        .statboxMainStat
        {
            
        }
        
        .statboxMainText
        {
            font-size: 1.5em;
        }
        
        .statboxSub
        {
            line-height: 1.3em;
        }
    </style>